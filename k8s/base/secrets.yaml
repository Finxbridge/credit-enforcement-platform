# ============================================
# KUBERNETES SECRETS TEMPLATE
# ============================================
#
# WHY SECRETS?
# - Docker Compose uses .env files (plain text, committed to git - INSECURE!)
# - Kubernetes Secrets store sensitive data encrypted at rest
# - Can be injected as environment variables or mounted as files
# - Can integrate with external secret managers (AWS Secrets Manager, HashiCorp Vault)
#
# IMPORTANT: This is a TEMPLATE file
# DO NOT commit actual secrets to git!
#
# DEPLOYMENT STEPS:
# 1. Copy this file: cp secrets.yaml secrets-actual.yaml
# 2. Replace <BASE64_ENCODED_VALUE> with actual base64 values
# 3. Add secrets-actual.yaml to .gitignore
# 4. Apply: kubectl apply -f secrets-actual.yaml
#
# To encode a value to base64:
#   echo -n "your-secret-value" | base64
#
# ============================================

---
apiVersion: v1
kind: Secret
metadata:
  name: postgres-credentials
  namespace: credit-enforcement
type: Opaque
data:
  # Your OVH PostgreSQL credentials
  # Current values from .env (EXAMPLE - DO NOT USE IN PRODUCTION):
  # host: postgresql-9011f0fc-o4187f84d.database.cloud.ovh.net
  # port: 20184
  # database: defaultdb
  # username: avnadmin
  # password: KE5PMicV9Z0aO1XJRNx3
  #
  # Base64 encode each value separately:
  postgres-host: <BASE64_ENCODED_HOST>
  postgres-port: <BASE64_ENCODED_PORT>
  postgres-database: <BASE64_ENCODED_DATABASE>
  postgres-username: <BASE64_ENCODED_USERNAME>
  postgres-password: <BASE64_ENCODED_PASSWORD>

---
apiVersion: v1
kind: Secret
metadata:
  name: jwt-secret
  namespace: credit-enforcement
type: Opaque
data:
  # JWT secret for token signing
  # Must be at least 256 bits for HS256 algorithm
  # Example command to generate secure secret:
  #   openssl rand -base64 32 | base64
  jwt-secret: <BASE64_ENCODED_JWT_SECRET>
  jwt-issuer: <BASE64_ENCODED_ISSUER>  # Example: finxbridge

---
apiVersion: v1
kind: Secret
metadata:
  name: redis-credentials
  namespace: credit-enforcement
type: Opaque
data:
  # Redis password (if you enable authentication)
  # For now, Redis in docker-compose has no password, but SHOULD in production
  # Leave empty if no auth, or set a strong password:
  #   openssl rand -base64 20 | base64
  redis-password: <BASE64_ENCODED_REDIS_PASSWORD_OR_EMPTY>

---
apiVersion: v1
kind: Secret
metadata:
  name: ovh-registry-secret
  namespace: credit-enforcement
type: kubernetes.io/dockerconfigjson
data:
  # This secret allows Kubernetes to pull images from your private OVH registry
  # Generate this with:
  #   kubectl create secret docker-registry ovh-registry-secret \
  #     --docker-server=qvwy18uw.c1.de1.container-registry.ovh.net \
  #     --docker-username=<YOUR_OVH_USERNAME> \
  #     --docker-password=<YOUR_OVH_PASSWORD> \
  #     --namespace=credit-enforcement \
  #     --dry-run=client -o yaml | grep '\.dockerconfigjson:' | awk '{print $2}'
  #
  .dockerconfigjson: <BASE64_ENCODED_DOCKER_CONFIG_JSON>

---
# CORS and other application configs can be in ConfigMap (non-sensitive)
# or here if you want to keep them private
apiVersion: v1
kind: Secret
metadata:
  name: app-config-secrets
  namespace: credit-enforcement
type: Opaque
data:
  # CORS allowed origins (if sensitive)
  cors-allowed-origins: <BASE64_ENCODED_CORS_ORIGINS>
